import{o as w,r as p,u as E,j as a,c as v,s as V,H as X,R as Y}from"./vendor-95b30d29.js";import{u as O,n as k,J as Z,I as ee,C as ae,F as S,e as N,j as se,d as H,K as D,M as _,m as ne,O as $,k as te,P as le,y as B,N as oe}from"./index-61e14e01.js";import{F as L,a as ie}from"./FormiumConfig-51a9911c.js";import{c as l}from"./Applications.module-90b26cc5.js";import{A as re}from"./AvatarWithTitle-90e4e708.js";import"./formium-7b85afc3.js";const U=w(({children:u,icon:e,onClick:g,name:o,active:b})=>{const[n,s]=p.useState(!1),{configStore:i}=O(),{t:f}=E(),C=()=>{const d=n?f("unsaved"):" ";return o==="webConfig"?i.wcChanged?d:"":i.acChanged?d:""};return a.jsxs(k.UI,{className:v(l.appTab,{[l.active]:b}),children:[a.jsx(Z,{bOnBadge:!0,className:v(l.changesTracking),vertical:"top",side:"left",color:"danger",size:"small",onHover:()=>s(!n),content:C(),onClick:g,children:a.jsx(ee,{className:l.appTabIcon,name:e,onClick:g})}),u]})}),ce="_root_11cg0_1",ge="_AvatarCol_11cg0_5",pe="_smCol_11cg0_9",fe="_label_11cg0_15",x={root:ce,AvatarCol:ge,smCol:pe,label:fe},de=w(function({app:e,className:g,onClick:o}){var z,F,P;const{permissionsStore:b,globalStore:n}=O(),s=n.info,[i,f]=p.useState(""),[C,d]=p.useState(!1),[T,m]=p.useState(!1),[y,j]=p.useState(!1),[t,r]=p.useState(!1),A=V(),{t:c}=E(),q=()=>{s.runningInstances!==0?j(!0):R()},I=h=>{n.loadInfo(h).then(()=>{var M,K;f(""),n.clearInterval(),d((M=n.info)==null?void 0:M.enabled),m(!((K=n.info)!=null&&K.enabled))}).then(()=>{n.setInterval(()=>{f(""),I(h)},5e3)}).catch(()=>{n.clearInterval()})},G=h=>{j(h)},Q=()=>{f("Requesting Start"),d(!1),m(!1),D.start(e||"").then(()=>{I(e),_(c("ok.successStartApp"))})},R=()=>{f("Requesting Stop"),d(!1),m(!1),D.stop(e||"").then(()=>{I(e),_(c("ok.successStopApp")),y&&j(!1)})},J=()=>{f("Uninstalling app"),d(!1),m(!1),D.remove(e).then(()=>{n.removePath(e),_(c("ok.successRemoveApp")),m(!0),A.push("/apps")})};return p.useEffect(()=>(f(""),I(e),()=>n.clearInterval()),[e]),a.jsxs(ae,{className:v(x.root,g),onClick:o,children:[a.jsxs(S,{style:{padding:"0 1rem"},children:[a.jsx(S,{bColumn:!0,className:x.AvatarCol,flex:2,children:a.jsx(re,{size:"medium",src:N+"/"+e+"/rest/appicon",title:s==null?void 0:s.name,className:x.manageApp})}),a.jsxs(S,{bColumn:!0,flex:1,className:x.smCol,justifyContent:"center",children:[a.jsxs("span",{className:x.label,children:[c("general.status"),":"]}),a.jsx(se,{status:(z=n.info)==null?void 0:z.status,loadMessage:i})]}),a.jsxs(S,{bColumn:!0,flex:1,className:x.smCol,justifyContent:"center",children:[a.jsxs("span",{className:x.label,children:[c("apps.path"),":"]}),a.jsx("a",{href:s==null?void 0:s.url,target:"_blank",rel:"noreferrer",children:s==null?void 0:s.path})]}),a.jsxs(S,{flex:2,justifyContent:"flex-end",alignItems:"center",children:[C&&b.get("stop")&&a.jsx(k,{color:"danger",size:"small",label:c("apps.disable"),onClick:q}),T&&b.get("start")&&a.jsx(k,{label:c("apps.enable"),size:"small",style:{marginRight:"6px"},onClick:Q}),T&&b.get("remove")&&a.jsx(k,{color:"danger",size:"small",label:c("apps.remove"),onClick:()=>r(h=>!h)})]})]}),a.jsx(H,{bOpen:y,title:c("sessions.warning"),footer:!0,onToggle:G,onConfirm:R,children:((F=n.info)==null?void 0:F.runningInstances)===1?c("apps.runningInstanceKillQ"):c("apps.runningInstancesKillQ",{runningInstances:(P=n.info)==null?void 0:P.runningInstances})}),a.jsx(H,{bOpen:t,title:c("apps.remove")+" "+e,footer:!0,onToggle:h=>r(h),onConfirm:J,children:c("apps.AreuSureRemove",{app:e})})]})}),W=w(({bLast:u,item:e,onClick:g})=>{const{configStore:o}=O();return a.jsx("li",{className:v({[l.fitem]:u}),children:a.jsx(ne,{className:l.popSwitch,position:"right",value:e.activeSP,onClick:()=>o.activeSpSwitch(e),children:a.jsxs("span",{onClick:()=>g(e.key),children:[e.key,e.wasEdited&&a.jsx($,{color:"danger",size:"small",className:l.coin,children:"  "})]})})},e.key)}),ve=w(()=>{var T,m,y,j;const{permissionsStore:u,configStore:e,globalStore:g}=O(),{app:o}=X(),[b,n]=p.useState(!1),{t:s,i18n:i}=E(),f=p.useCallback(()=>{var t;(t=g.info)!=null&&t.cluster?n(r=>!r):e.openTab(e.allOrOne)},[n]),C=p.useCallback(t=>{e.openTab(t),n(r=>!r)},[n]),d=()=>!g.isCluster||e.hasAllInactive||e.allOrOne==="allID"?s("config.appConfig"):`${s("config.appConfig")} (${e.allOrOne})`;return p.useEffect(()=>()=>{e.clearConfigData()},[]),p.useEffect(()=>{e.loadConfig(o),g.updateApp(o),g.toggleAddApp&&g.setToggleAddApp(!1)},[o]),te(s("routes.appConfig")),a.jsxs(a.Fragment,{children:[a.jsx(de,{app:o}),a.jsxs(S,{className:l.stickyBtnGroup,children:[a.jsx(U,{name:"webConfig",icon:"web",onClick:()=>e.openTab("webConfig"),active:e.activeTab==="webConfig",children:a.jsx("div",{className:l.appTabText,onClick:()=>e.openTab("webConfig"),children:s("config.webConfig")})}),a.jsxs(U,{name:"appConfig",icon:"av_timer",onClick:f,active:e.activeTab==="allID"||e.isTab(),children:[a.jsx("div",{className:l.appTabText,onClick:()=>e.openTab(e.allOrOne),children:d()}),a.jsx(le,{backdrop:!0,className:v(l.popover),open:b,side:"left",onBlur:f,children:a.jsxs("ul",{className:l.popList,children:[!e.hideALL&&a.jsxs("li",{className:l.fitem,onClick:()=>C("allID"),children:[s("config.allSessionConfig"),e.allConfigWasEdited&&a.jsx($,{color:"danger",size:"small",className:l.coin,children:"  "})]}),!e.hasAllInactive&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:l.appLabel,children:[s("config.activeSP"),":"]}),e.activeTabs.map((t,r)=>a.jsx(W,{bLast:e.activeTabs.length===r+1,item:t,onClick:()=>C(t.key)},t.key))]}),!e.hasAllActive&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:l.appLabel,children:[s("config.inactiveSP"),":"]}),e.inactiveTabs.map((t,r)=>a.jsx(W,{bLast:e.inactiveTabs.length===r+1,item:t,onClick:()=>C(t.key)},t.key))]})]})})]})]}),a.jsxs("div",{className:v(l.appTabContent),children:[e.activeTab==="webConfig"&&a.jsx(L,{readonly:!u.get("configSwingEdit"),identify:o,path:B(N,o),value:(T=e.config)==null?void 0:T.webConfig,hide:ie,translations:(m=i.getDataByLanguage(i.language))==null?void 0:m.translation,lang:i.language}),e.activeTab==="allID"&&!e.hideALL&&a.jsx(L,{readonly:!u.get("configSwingEdit"),identify:"allID",path:B(N,o),list:(y=e.config)==null?void 0:y.appConfig,translations:(j=i.getDataByLanguage(i.language))==null?void 0:j.translation,lang:i.language}),e.tabs.map(t=>{var r,A;return a.jsx(Y.Fragment,{children:e.isTab(t.key)&&a.jsx(L,{readonly:!u.get("configSwingEdit"),identify:t.key,path:B(N,o),value:(r=e.config)==null?void 0:r.appConfig[t.key],istab:!0,translations:(A=i.getDataByLanguage(i.language))==null?void 0:A.translation,lang:i.language})},t.key)}),e.hasAllInactive&&e.activeTab!=="webConfig"&&a.jsx(oe,{message:s("apps.noActiveSps"),children:a.jsx(k,{icon:"refresh",color:"neutral",onClick:()=>e.loadConfig(o)})})]}),a.jsx(k.Group,{className:v(l.floatingButtons,{[l.activeApply]:e.activeApply}),buttons:[{label:s("general.apply"),size:"small",color:"blue",onClick:()=>e.setConfig(o)},{label:s("general.reset"),size:"small",color:"white",onClick:()=>e.resetConfig(o)}]})]})});export{ve as default};
//# sourceMappingURL=AppsSwing-1cebdb08.js.map
